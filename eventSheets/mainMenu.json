{
	"name": "mainMenu",
	"events": [
		{
			"eventType": "include",
			"includeSheet": "global"
		},
		{
			"eventType": "variable",
			"name": "updateAvailable",
			"type": "boolean",
			"initialValue": "false",
			"comment": "Whether or not an update is available.",
			"isStatic": false,
			"isConstant": false,
			"sid": 348595350968897
		},
		{
			"eventType": "block",
			"conditions": [
				{
					"id": "on-object-clicked",
					"objectClass": "mouse",
					"sid": 628849515389079,
					"parameters": {
						"mouse-button": "left",
						"click-type": "clicked",
						"object-clicked": "play"
					}
				}
			],
			"actions": [
				{
					"id": "stop-all",
					"objectClass": "Audio",
					"sid": 574841534203778
				},
				{
					"callFunction": "changeLayout",
					"sid": 360154941051278,
					"parameters": [
						"\"farm\""
					]
				}
			],
			"sid": 387251329612208
		},
		{
			"eventType": "comment",
			"text": "There's no way to do an \"On update not found\" trigger: https://www.construct.net/en/forum/construct-3/how-do-i-8/start-game-browser-not-update-175590"
		},
		{
			"eventType": "block",
			"conditions": [
				{
					"id": "on-update-found-sw",
					"objectClass": "browser",
					"sid": 230525362101227
				}
			],
			"actions": [
				{
					"id": "set-boolean-eventvar",
					"objectClass": "System",
					"sid": 788244121458818,
					"parameters": {
						"variable": "updateAvailable",
						"value": "true"
					}
				}
			],
			"sid": 282848727504620
		},
		{
			"eventType": "block",
			"conditions": [
				{
					"id": "compare-boolean-eventvar",
					"objectClass": "System",
					"sid": 603860594460344,
					"parameters": {
						"variable": "updateAvailable"
					}
				},
				{
					"id": "every-x-seconds",
					"objectClass": "System",
					"sid": 945239623243495,
					"parameters": {
						"interval-seconds": "1.0"
					}
				}
			],
			"actions": [
				{
					"id": "set-text",
					"objectClass": "launcherMessage",
					"sid": 648060711973366,
					"parameters": {
						"text": "Self.Text = \"Update available. Downloading...\" ? \"Update available. Downloading\" : Self.Text & \".\""
					}
				}
			],
			"sid": 703745360602145
		},
		{
			"eventType": "block",
			"conditions": [
				{
					"id": "on-update-ready-sw",
					"objectClass": "browser",
					"sid": 800806806584944
				}
			],
			"actions": [
				{
					"id": "reload",
					"objectClass": "browser",
					"sid": 187265594295630
				}
			],
			"sid": 519782063417592
		},
		{
			"eventType": "block",
			"conditions": [
				{
					"id": "on-any-click",
					"objectClass": "mouse",
					"sid": 534646384122371
				},
				{
					"id": "on-any-key-pressed",
					"objectClass": "keyboard",
					"sid": 346196279412257
				}
			],
			"actions": [
				{
					"id": "log",
					"objectClass": "browser",
					"sid": 619530873243850,
					"parameters": {
						"type": "log",
						"message": "\"Current URL: \" & Self.URL"
					}
				}
			],
			"sid": 403514843034258,
			"children": [
				{
					"eventType": "variable",
					"name": "REQUIRED_PROTOCOL",
					"type": "string",
					"initialValue": "https:",
					"comment": "The required protocol.",
					"isStatic": false,
					"isConstant": true,
					"sid": 700212028262996
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "layer-is-visible",
							"objectClass": "System",
							"sid": 843857722539970,
							"parameters": {
								"layer": "\"launcher\""
							}
						},
						{
							"id": "compare-text",
							"objectClass": "launcherMessage",
							"sid": 641890998744744,
							"parameters": {
								"text-to-compare": "\"Press any key\r\nto start\"",
								"case-sensitivity": "ignore-case"
							}
						},
						{
							"id": "compare-two-values",
							"objectClass": "System",
							"sid": 373770140686063,
							"parameters": {
								"first-value": "browser.Protocol",
								"comparison": 0,
								"second-value": "REQUIRED_PROTOCOL"
							}
						},
						{
							"id": "evaluate-expression",
							"objectClass": "System",
							"sid": 217642840212063,
							"parameters": {
								"value": "browser.Domain = \"preview.construct.net\" | browser.Domain = \"daggerquest.netlify.app\" | browser.Domain = \"daggerquesttest.netlify.app\""
							}
						}
					],
					"actions": [
						{
							"type": "comment",
							"text": "Verify we are on an approved URL at which we can play DaggerQuest"
						},
						{
							"id": "set-layer-visible",
							"objectClass": "System",
							"sid": 631789550966149,
							"parameters": {
								"layer": "\"launcher\"",
								"visibility": "invisible"
							}
						},
						{
							"id": "set-text",
							"objectClass": "versionText",
							"sid": 700194361988956,
							"parameters": {
								"text": "projectversion"
							}
						},
						{
							"id": "set-looping",
							"objectClass": "video",
							"sid": 396807237423762,
							"parameters": {
								"mode": "looping"
							}
						},
						{
							"id": "play",
							"objectClass": "video",
							"sid": 477631205210615
						},
						{
							"id": "play-by-name",
							"objectClass": "Audio",
							"sid": 882944472104573,
							"parameters": {
								"folder": "sounds",
								"audio-file-name": "LayoutName",
								"loop": "not-looping",
								"volume": "0",
								"stereo-pan": "0",
								"tag-optional": "\"\""
							}
						}
					],
					"sid": 548421181255801,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "is-in-preview",
									"objectClass": "System",
									"sid": 389419661755640,
									"isInverted": true
								}
							],
							"actions": [
								{
									"id": "request-fullscreen",
									"objectClass": "browser",
									"sid": 224313851080210,
									"parameters": {
										"mode": "stretch-letterbox-scale",
										"navigation-ui": "auto"
									}
								}
							],
							"sid": 142253453144409
						}
					]
				}
			],
			"isOrBlock": true
		},
		{
			"eventType": "block",
			"conditions": [
				{
					"id": "on-start-of-layout",
					"objectClass": "System",
					"sid": 946803817926759
				}
			],
			"actions": [
				{
					"type": "comment",
					"text": "load and parse out data"
				},
				{
					"id": "request-project-file",
					"objectClass": "AJAX",
					"sid": 956434365266252,
					"parameters": {
						"tag": "\"dialog\"",
						"file": "npcDialog.json"
					}
				},
				{
					"id": "wait-for-previous-actions",
					"objectClass": "System",
					"sid": 295735231419875
				},
				{
					"id": "load",
					"objectClass": "npcDialogArray",
					"sid": 844317280094480,
					"parameters": {
						"json": "AJAX.LastData"
					}
				},
				{
					"id": "request-project-file",
					"objectClass": "AJAX",
					"sid": 506562656656289,
					"parameters": {
						"tag": "\"abilities\"",
						"file": "abilities.json"
					}
				},
				{
					"id": "wait-for-previous-actions",
					"objectClass": "System",
					"sid": 398902564116133
				},
				{
					"id": "load",
					"objectClass": "abilitiesArray",
					"sid": 396459081626329,
					"parameters": {
						"json": "AJAX.LastData"
					}
				},
				{
					"id": "request-project-file",
					"objectClass": "AJAX",
					"sid": 146287302423642,
					"parameters": {
						"tag": "\"equipment\"",
						"file": "equipment.json"
					}
				},
				{
					"id": "wait-for-previous-actions",
					"objectClass": "System",
					"sid": 782418614714510
				},
				{
					"id": "load",
					"objectClass": "equipmentArray",
					"sid": 363015208101347,
					"parameters": {
						"json": "AJAX.LastData"
					}
				},
				{
					"id": "createProbabilityTable",
					"objectClass": "advancedRandom",
					"sid": 589755637315110,
					"parameters": {
						"name": "\"equipment\""
					}
				},
				{
					"id": "request-project-file",
					"objectClass": "AJAX",
					"sid": 645465400982240,
					"parameters": {
						"tag": "\"mods\"",
						"file": "mods.json"
					}
				},
				{
					"id": "wait-for-previous-actions",
					"objectClass": "System",
					"sid": 652608021910300
				},
				{
					"id": "load",
					"objectClass": "modsArray",
					"sid": 222374248368866,
					"parameters": {
						"json": "AJAX.LastData"
					}
				},
				{
					"id": "request-project-file",
					"objectClass": "AJAX",
					"sid": 902746416325749,
					"parameters": {
						"tag": "\"modRelationships\"",
						"file": "modRelationships.json"
					}
				},
				{
					"id": "wait-for-previous-actions",
					"objectClass": "System",
					"sid": 137711395224364
				},
				{
					"id": "load",
					"objectClass": "modRelationshipsArray",
					"sid": 884939669111498,
					"parameters": {
						"json": "AJAX.LastData"
					}
				},
				{
					"id": "createProbabilityTable",
					"objectClass": "advancedRandom",
					"sid": 713064954756824,
					"parameters": {
						"name": "\"modValues\""
					}
				},
				{
					"type": "comment",
					"text": "map function mods - equipment mods"
				},
				{
					"id": "map-function",
					"objectClass": "Functions",
					"sid": 254514418201188,
					"parameters": {
						"name": "\"equipmentMods\"",
						"string": "\"flatHealth\"",
						"function": "flatHealth"
					}
				},
				{
					"id": "map-function",
					"objectClass": "Functions",
					"sid": 939799022125051,
					"parameters": {
						"name": "\"equipmentMods\"",
						"string": "\"flatSlash\"",
						"function": "flatSlash"
					}
				},
				{
					"id": "map-function",
					"objectClass": "Functions",
					"sid": 822091172055206,
					"parameters": {
						"name": "\"equipmentMods\"",
						"string": "\"flatStab\"",
						"function": "flatStab"
					}
				},
				{
					"id": "map-function",
					"objectClass": "Functions",
					"sid": 446904202464671,
					"parameters": {
						"name": "\"equipmentMods\"",
						"string": "\"flatSmash\"",
						"function": "flatSmash"
					}
				},
				{
					"id": "map-function",
					"objectClass": "Functions",
					"sid": 380356685921001,
					"parameters": {
						"name": "\"equipmentMods\"",
						"string": "\"flatBlockChance\"",
						"function": "flatBlockChance"
					}
				},
				{
					"id": "map-function",
					"objectClass": "Functions",
					"sid": 926182812600624,
					"parameters": {
						"name": "\"equipmentMods\"",
						"string": "\"flatManaRegen\"",
						"function": "flatManaRegen"
					}
				},
				{
					"id": "map-function",
					"objectClass": "Functions",
					"sid": 794618406892867,
					"parameters": {
						"name": "\"equipmentMods\"",
						"string": "\"flatSlashAndStab\"",
						"function": "flatSlashAndStab"
					}
				},
				{
					"id": "map-function",
					"objectClass": "Functions",
					"sid": 381104098226937,
					"parameters": {
						"name": "\"equipmentMods\"",
						"string": "\"flatPhysical\"",
						"function": "flatPhysical"
					}
				},
				{
					"type": "comment",
					"text": "map function mods - player abilities"
				},
				{
					"id": "map-function",
					"objectClass": "Functions",
					"sid": 787774835828130,
					"parameters": {
						"name": "\"playerAbilities\"",
						"string": "\"basicAttack\"",
						"function": "basicAttack"
					}
				},
				{
					"id": "map-function",
					"objectClass": "Functions",
					"sid": 226644337331128,
					"parameters": {
						"name": "\"playerAbilities\"",
						"string": "\"heroicStrike\"",
						"function": "heroicStrike"
					}
				},
				{
					"id": "map-function",
					"objectClass": "Functions",
					"sid": 613298493664662,
					"parameters": {
						"name": "\"playerAbilities\"",
						"string": "\"kick\"",
						"function": "kick"
					}
				},
				{
					"type": "comment",
					"text": "map function mods - enemy abilities"
				},
				{
					"id": "map-function",
					"objectClass": "Functions",
					"sid": 914116114384026,
					"parameters": {
						"name": "\"enemyAbilities\"",
						"string": "\"goblinUnderling\"",
						"function": "goblinUnderling"
					}
				},
				{
					"id": "map-function",
					"objectClass": "Functions",
					"sid": 549277776160813,
					"parameters": {
						"name": "\"enemyAbilities\"",
						"string": "\"goblinWarlock\"",
						"function": "goblinWarlock"
					}
				},
				{
					"id": "map-function",
					"objectClass": "Functions",
					"sid": 995116517244533,
					"parameters": {
						"name": "\"enemyAbilities\"",
						"string": "\"goblinArcher\"",
						"function": "goblinArcher"
					}
				},
				{
					"id": "setProbabilityTable",
					"objectClass": "advancedRandom",
					"sid": 906294426028736,
					"parameters": {
						"name": "\"equipment\""
					}
				}
			],
			"sid": 585119083439075,
			"children": [
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "for",
							"objectClass": "System",
							"sid": 445529993828927,
							"parameters": {
								"name": "\"\"",
								"start-index": "1",
								"end-index": "equipmentArray.Height - 1"
							}
						}
					],
					"actions": [
						{
							"type": "comment",
							"text": "Generate equipment probability table"
						},
						{
							"id": "addProbabilityEntry",
							"objectClass": "advancedRandom",
							"sid": 987104752454297,
							"parameters": {
								"value": "equipmentArray.At(Functions.getColumnNumber(equipmentArray.ObjectTypeName, \"simpleName\"), loopindex)",
								"weight": "equipmentArray.At(Functions.getColumnNumber(equipmentArray.ObjectTypeName, \"rarity\"), loopindex)"
							}
						}
					],
					"sid": 534768195790150
				},
				{
					"eventType": "variable",
					"name": "modTableName",
					"type": "string",
					"initialValue": "",
					"comment": "The name of the modTable to create and use",
					"isStatic": true,
					"isConstant": false,
					"sid": 985469923213391
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "for",
							"objectClass": "System",
							"sid": 733076679683202,
							"parameters": {
								"name": "\"\"",
								"start-index": "1",
								"end-index": "equipmentArray.Height - 1"
							}
						}
					],
					"actions": [
						{
							"type": "comment",
							"text": "Populate the modTableNamesArray with the values from the modTable column in the equipmentArray"
						},
						{
							"id": "set-eventvar-value",
							"objectClass": "System",
							"sid": 955464002989486,
							"parameters": {
								"variable": "modTableName",
								"value": "equipmentArray.At(Functions.getColumnNumber(equipmentArray.ObjectTypeName, \"modTable\"), loopindex)"
							}
						}
					],
					"sid": 802888496706870,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "contains-value",
									"objectClass": "modTableNamesArray",
									"sid": 421985059327183,
									"parameters": {
										"value": "modTableName"
									},
									"isInverted": true
								}
							],
							"actions": [
								{
									"id": "push",
									"objectClass": "modTableNamesArray",
									"sid": 263662159621660,
									"parameters": {
										"where": "back",
										"value": "modTableName",
										"axis": "x"
									}
								}
							],
							"sid": 588116558642709
						}
					]
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "for-each-element",
							"objectClass": "modTableNamesArray",
							"sid": 956533924844134,
							"parameters": {
								"axes": "x"
							}
						}
					],
					"actions": [
						{
							"id": "set-eventvar-value",
							"objectClass": "System",
							"sid": 987951528959915,
							"parameters": {
								"variable": "modTableName",
								"value": "modTableNamesArray.CurValue"
							}
						},
						{
							"id": "createProbabilityTable",
							"objectClass": "advancedRandom",
							"sid": 290537714462890,
							"parameters": {
								"name": "modTableName"
							}
						},
						{
							"id": "setProbabilityTable",
							"objectClass": "advancedRandom",
							"sid": 137630922500358,
							"parameters": {
								"name": "modTableName"
							}
						}
					],
					"sid": 250804452104542,
					"children": [
						{
							"eventType": "variable",
							"name": "modName",
							"type": "string",
							"initialValue": "",
							"comment": "",
							"isStatic": true,
							"isConstant": false,
							"sid": 612258051814023
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "for",
									"objectClass": "System",
									"sid": 880258983478922,
									"parameters": {
										"name": "\"\"",
										"start-index": "1",
										"end-index": "modRelationshipsArray.Height - 1"
									}
								},
								{
									"id": "compare-two-values",
									"objectClass": "System",
									"sid": 924487497853598,
									"parameters": {
										"first-value": "modRelationshipsArray.At(Functions.getColumnNumber(modRelationshipsArray.ObjectTypeName, \"modTableName\"), loopindex)",
										"comparison": 0,
										"second-value": "modTableName"
									}
								}
							],
							"actions": [
								{
									"id": "set-eventvar-value",
									"objectClass": "System",
									"sid": 118127450779178,
									"parameters": {
										"variable": "modName",
										"value": "modRelationshipsArray.At(Functions.getColumnNumber(modRelationshipsArray.ObjectTypeName, \"mod\"), loopindex)"
									}
								},
								{
									"id": "addProbabilityEntry",
									"objectClass": "advancedRandom",
									"sid": 402993156548665,
									"parameters": {
										"value": "modName",
										"weight": "int(Functions.arrayLookup(modsArray.ObjectTypeName, \"simpleName\", modName, \"rarity\"))"
									}
								}
							],
							"sid": 653951801548831
						}
					]
				}
			]
		}
	],
	"sid": 722961205554376
}