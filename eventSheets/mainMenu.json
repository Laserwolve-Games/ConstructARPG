{
	"name": "mainMenu",
	"events": [
		{
			"eventType": "include",
			"includeSheet": "allLayouts"
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "main menu",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "variable",
					"name": "RARITY_KEYWORD",
					"type": "string",
					"initialValue": "rarity",
					"comment": "Used for looking up rarity in an array.",
					"isStatic": false,
					"isConstant": true,
					"sid": 713133308773562
				},
				{
					"eventType": "variable",
					"name": "FIRST_GAME_LAYOUT",
					"type": "string",
					"initialValue": "farm",
					"comment": "The name of the layout to go to after after the main menu.",
					"isStatic": false,
					"isConstant": true,
					"sid": 505358137732277
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-object-clicked",
							"objectClass": "mouse",
							"sid": 513273473779613,
							"parameters": {
								"mouse-button": "left",
								"click-type": "clicked",
								"object-clicked": "play"
							}
						}
					],
					"actions": [
						{
							"id": "play",
							"objectClass": "Audio",
							"sid": 218128725399305,
							"parameters": {
								"audio-file": "menuOpen",
								"loop": "not-looping",
								"volume": "interfaceVolume",
								"stereo-pan": "DEFAULT_STEREO_PAN",
								"tag-optional": "NOT_USED"
							}
						},
						{
							"callFunction": "changeLayout",
							"sid": 934225930353188,
							"parameters": [
								"FIRST_GAME_LAYOUT",
								false
							]
						}
					],
					"sid": 620884769961856
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-start-of-layout",
							"objectClass": "System",
							"sid": 280553362269890
						}
					],
					"actions": [
						{
							"id": "set-looping",
							"objectClass": "video",
							"sid": 943770953649697,
							"parameters": {
								"mode": "looping"
							}
						},
						{
							"id": "set-text",
							"objectClass": "versionText",
							"sid": 130196031881065,
							"parameters": {
								"text": "projectversion"
							}
						},
						{
							"type": "comment",
							"text": "Load and parse out data"
						},
						{
							"type": "comment",
							"text": "We can't put these into a 'for each queriedArray' loop because 'Wait for previous actions to complete' doesn't hold up a loop.\n\nWe also tried `AJAX On any completed' with `Pick queriedArray where queriedArray.ObjectTypeName = AJAX.tag`, but the probability table generation loops executed before the AJAX requests had finished.",
							"text-color": [
								0.7843137254901961,
								0.7843137254901961,
								0.7843137254901961,
								1
							],
							"background-color": [
								0.39215686274509803,
								0,
								0,
								1
							]
						},
						{
							"type": "comment",
							"text": "Create AJAX objects for each correlating array, and loop through a family of them and a family of these queries.",
							"text-color": [
								0.7843137254901961,
								0.7843137254901961,
								0.7843137254901961,
								1
							],
							"background-color": [
								0,
								0,
								0.39215686274509803,
								1
							]
						},
						{
							"id": "request-project-file",
							"objectClass": "AJAX",
							"sid": 384921091103022,
							"parameters": {
								"tag": "NOT_USED",
								"file": "abilities.json"
							}
						},
						{
							"id": "wait-for-previous-actions",
							"objectClass": "System",
							"sid": 809519838010153
						},
						{
							"id": "load",
							"objectClass": "abilitiesArray",
							"sid": 981862557028016,
							"parameters": {
								"json": "AJAX.LastData"
							}
						},
						{
							"id": "request-project-file",
							"objectClass": "AJAX",
							"sid": 528457112839553,
							"parameters": {
								"tag": "NOT_USED",
								"file": "equipment.json"
							}
						},
						{
							"id": "wait-for-previous-actions",
							"objectClass": "System",
							"sid": 254787881998834
						},
						{
							"id": "load",
							"objectClass": "equipmentArray",
							"sid": 363219999566631,
							"parameters": {
								"json": "AJAX.LastData"
							}
						},
						{
							"id": "request-project-file",
							"objectClass": "AJAX",
							"sid": 909748722225529,
							"parameters": {
								"tag": "NOT_USED",
								"file": "modRelationships.json"
							}
						},
						{
							"id": "wait-for-previous-actions",
							"objectClass": "System",
							"sid": 212615390867543
						},
						{
							"id": "load",
							"objectClass": "modRelationshipsArray",
							"sid": 273024253955135,
							"parameters": {
								"json": "AJAX.LastData"
							}
						},
						{
							"id": "request-project-file",
							"objectClass": "AJAX",
							"sid": 682130553419063,
							"parameters": {
								"tag": "NOT_USED",
								"file": "mods.json"
							}
						},
						{
							"id": "wait-for-previous-actions",
							"objectClass": "System",
							"sid": 398876009325482
						},
						{
							"id": "load",
							"objectClass": "modsArray",
							"sid": 368641761710437,
							"parameters": {
								"json": "AJAX.LastData"
							}
						},
						{
							"id": "request-project-file",
							"objectClass": "AJAX",
							"sid": 168667371891151,
							"parameters": {
								"tag": "NOT_USED",
								"file": "npcDialog.json"
							}
						},
						{
							"id": "wait-for-previous-actions",
							"objectClass": "System",
							"sid": 799771817070481
						},
						{
							"id": "load",
							"objectClass": "npcDialogArray",
							"sid": 595322981635016,
							"parameters": {
								"json": "AJAX.LastData"
							}
						},
						{
							"type": "comment",
							"text": "map function mods - equipment mods"
						},
						{
							"id": "map-function",
							"objectClass": "Functions",
							"sid": 345890480257314,
							"parameters": {
								"name": "EQUIPMENT_MODS_FUNCTION_MAP",
								"string": "\"flatHealth\"",
								"function": "flatHealth"
							}
						},
						{
							"id": "map-function",
							"objectClass": "Functions",
							"sid": 733642978878028,
							"parameters": {
								"name": "EQUIPMENT_MODS_FUNCTION_MAP",
								"string": "\"flatSlash\"",
								"function": "flatSlash"
							}
						},
						{
							"id": "map-function",
							"objectClass": "Functions",
							"sid": 829554034994622,
							"parameters": {
								"name": "EQUIPMENT_MODS_FUNCTION_MAP",
								"string": "\"flatStab\"",
								"function": "flatStab"
							}
						},
						{
							"id": "map-function",
							"objectClass": "Functions",
							"sid": 255640528730017,
							"parameters": {
								"name": "EQUIPMENT_MODS_FUNCTION_MAP",
								"string": "\"flatSmash\"",
								"function": "flatSmash"
							}
						},
						{
							"id": "map-function",
							"objectClass": "Functions",
							"sid": 725977673587952,
							"parameters": {
								"name": "EQUIPMENT_MODS_FUNCTION_MAP",
								"string": "\"flatBlockChance\"",
								"function": "flatBlockChance"
							}
						},
						{
							"id": "map-function",
							"objectClass": "Functions",
							"sid": 717066286693037,
							"parameters": {
								"name": "EQUIPMENT_MODS_FUNCTION_MAP",
								"string": "\"flatManaRegen\"",
								"function": "flatManaRegen"
							}
						},
						{
							"id": "map-function",
							"objectClass": "Functions",
							"sid": 408565706906119,
							"parameters": {
								"name": "EQUIPMENT_MODS_FUNCTION_MAP",
								"string": "\"flatSlashAndStab\"",
								"function": "flatSlashAndStab"
							}
						},
						{
							"id": "map-function",
							"objectClass": "Functions",
							"sid": 107983141996073,
							"parameters": {
								"name": "EQUIPMENT_MODS_FUNCTION_MAP",
								"string": "\"flatPhysical\"",
								"function": "flatPhysical"
							}
						},
						{
							"type": "comment",
							"text": "map function mods - player abilities"
						},
						{
							"id": "map-function",
							"objectClass": "Functions",
							"sid": 838961742511416,
							"parameters": {
								"name": "PLAYER_ABILITIES_FUNCTION_MAP",
								"string": "\"basicAttack\"",
								"function": "basicAttack"
							}
						},
						{
							"id": "map-function",
							"objectClass": "Functions",
							"sid": 632305729917025,
							"parameters": {
								"name": "PLAYER_ABILITIES_FUNCTION_MAP",
								"string": "\"heroicStrike\"",
								"function": "heroicStrike"
							}
						},
						{
							"id": "map-function",
							"objectClass": "Functions",
							"sid": 306490127491708,
							"parameters": {
								"name": "PLAYER_ABILITIES_FUNCTION_MAP",
								"string": "\"kick\"",
								"function": "kick"
							}
						},
						{
							"type": "comment",
							"text": "map function mods - enemy abilities"
						},
						{
							"id": "map-function",
							"objectClass": "Functions",
							"sid": 379366099281862,
							"parameters": {
								"name": "ENEMY_ABILITIES_FUNCTION_MAP",
								"string": "\"goblinUnderling\"",
								"function": "goblinUnderling"
							}
						},
						{
							"id": "map-function",
							"objectClass": "Functions",
							"sid": 836255042677348,
							"parameters": {
								"name": "ENEMY_ABILITIES_FUNCTION_MAP",
								"string": "\"goblinWarlock\"",
								"function": "goblinWarlock"
							}
						},
						{
							"id": "map-function",
							"objectClass": "Functions",
							"sid": 105849572345778,
							"parameters": {
								"name": "ENEMY_ABILITIES_FUNCTION_MAP",
								"string": "\"goblinArcher\"",
								"function": "goblinArcher"
							}
						},
						{
							"type": "comment",
							"text": "Create the mod values probability table, which gets populated during loot generation"
						},
						{
							"id": "createProbabilityTable",
							"objectClass": "advancedRandom",
							"sid": 476973755860885,
							"parameters": {
								"name": "MOD_VALUES_PROBABILITY_TABLE"
							}
						},
						{
							"type": "comment",
							"text": "Check to see if we already have local storage data"
						},
						{
							"id": "check-item-exists",
							"objectClass": "LocalStorage",
							"sid": 655505197572964,
							"parameters": {
								"key": "localStorageDictionary.ObjectTypeName"
							}
						}
					],
					"sid": 475031808944228
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-item-exists",
							"objectClass": "LocalStorage",
							"sid": 277614582725019,
							"parameters": {
								"key": "localStorageDictionary.ObjectTypeName"
							}
						}
					],
					"actions": [
						{
							"id": "load",
							"objectClass": "localStorageDictionary",
							"sid": 376966467105197,
							"parameters": {
								"json": "LocalStorage.ItemValue"
							}
						},
						{
							"id": "createProbabilityTableFromJSON",
							"objectClass": "advancedRandom",
							"sid": 904127192881310,
							"parameters": {
								"name": "EQUIPMENT_PROBABILITY_TABLE",
								"json": "localStorageDictionary.Get(EQUIPMENT_PROBABILITY_TABLE)"
							}
						},
						{
							"id": "load",
							"objectClass": "modTablesArray",
							"sid": 734010742244167,
							"parameters": {
								"json": "localStorageDictionary.Get(modTablesArray.ObjectTypeName)"
							}
						}
					],
					"sid": 823012996253306,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "for-each-element",
									"objectClass": "modTablesArray",
									"sid": 720487385246145,
									"parameters": {
										"axes": "x"
									}
								}
							],
							"actions": [
								{
									"id": "createProbabilityTableFromJSON",
									"objectClass": "advancedRandom",
									"sid": 191556229213238,
									"parameters": {
										"name": "modTablesArray.CurValue",
										"json": "localStorageDictionary.Get(modTablesArray.CurValue)"
									}
								}
							],
							"sid": 508851672498607
						}
					]
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-item-missing",
							"objectClass": "LocalStorage",
							"sid": 269541345627265,
							"parameters": {
								"key": "localStorageDictionary.ObjectTypeName"
							}
						}
					],
					"actions": [
						{
							"id": "createProbabilityTable",
							"objectClass": "advancedRandom",
							"sid": 785984218437475,
							"parameters": {
								"name": "EQUIPMENT_PROBABILITY_TABLE"
							}
						},
						{
							"id": "setProbabilityTable",
							"objectClass": "advancedRandom",
							"sid": 493172574422822,
							"parameters": {
								"name": "EQUIPMENT_PROBABILITY_TABLE"
							}
						}
					],
					"sid": 568163851112755,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "for",
									"objectClass": "System",
									"sid": 712062377668744,
									"parameters": {
										"name": "NOT_USED",
										"start-index": "LOOP_OFFSET",
										"end-index": "equipmentArray.Height - LOOP_OFFSET"
									}
								}
							],
							"actions": [
								{
									"type": "comment",
									"text": "Generate equipment probability table"
								},
								{
									"id": "addProbabilityEntry",
									"objectClass": "advancedRandom",
									"sid": 777403388709065,
									"parameters": {
										"value": "equipmentArray.At(Functions.getColumnNumber(equipmentArray.ObjectTypeName, SIMPLE_NAME_KEYWORD), loopindex)",
										"weight": "equipmentArray.At(Functions.getColumnNumber(equipmentArray.ObjectTypeName, RARITY_KEYWORD), loopindex)"
									}
								}
							],
							"sid": 983645403528728
						},
						{
							"eventType": "block",
							"conditions": [],
							"actions": [
								{
									"id": "add-key",
									"objectClass": "localStorageDictionary",
									"sid": 515040049425417,
									"parameters": {
										"key": "EQUIPMENT_PROBABILITY_TABLE",
										"value": "advancedRandom.ProbabilityTableAsJSON"
									}
								}
							],
							"sid": 220148979746840
						},
						{
							"eventType": "variable",
							"name": "modTable",
							"type": "string",
							"initialValue": "",
							"comment": "The name of the modTable to create and use",
							"isStatic": true,
							"isConstant": false,
							"sid": 679500708336622
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "for",
									"objectClass": "System",
									"sid": 743767806453054,
									"parameters": {
										"name": "NOT_USED",
										"start-index": "LOOP_OFFSET",
										"end-index": "equipmentArray.Height - LOOP_OFFSET"
									}
								}
							],
							"actions": [
								{
									"type": "comment",
									"text": "Populate the modTablesArray with the unique values from the modTable column in the equipmentArray"
								},
								{
									"id": "set-eventvar-value",
									"objectClass": "System",
									"sid": 692677019107933,
									"parameters": {
										"variable": "modTable",
										"value": "equipmentArray.At(Functions.getColumnNumber(equipmentArray.ObjectTypeName, MOD_TABLE_KEYWORD), loopindex)"
									}
								}
							],
							"sid": 721446798873208,
							"children": [
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "contains-value",
											"objectClass": "modTablesArray",
											"sid": 395811978102875,
											"parameters": {
												"value": "modTable"
											},
											"isInverted": true
										}
									],
									"actions": [
										{
											"id": "push",
											"objectClass": "modTablesArray",
											"sid": 989311020118705,
											"parameters": {
												"where": "back",
												"value": "modTable",
												"axis": "x"
											}
										}
									],
									"sid": 679957316318850
								}
							]
						},
						{
							"eventType": "block",
							"conditions": [],
							"actions": [
								{
									"id": "add-key",
									"objectClass": "localStorageDictionary",
									"sid": 448510921064220,
									"parameters": {
										"key": "modTablesArray.ObjectTypeName",
										"value": "modTablesArray.AsJSON"
									}
								}
							],
							"sid": 662977497641478
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "for-each-element",
									"objectClass": "modTablesArray",
									"sid": 196257015915289,
									"parameters": {
										"axes": "x"
									}
								}
							],
							"actions": [
								{
									"id": "set-eventvar-value",
									"objectClass": "System",
									"sid": 504520450983131,
									"parameters": {
										"variable": "modTable",
										"value": "modTablesArray.CurValue"
									}
								},
								{
									"id": "createProbabilityTable",
									"objectClass": "advancedRandom",
									"sid": 264906053479819,
									"parameters": {
										"name": "modTable"
									}
								},
								{
									"id": "setProbabilityTable",
									"objectClass": "advancedRandom",
									"sid": 493231458881833,
									"parameters": {
										"name": "modTable"
									}
								}
							],
							"sid": 927471251848430,
							"children": [
								{
									"eventType": "variable",
									"name": "MOD_KEYWORD",
									"type": "string",
									"initialValue": "mod",
									"comment": "Used when adding mods to mod tables.",
									"isStatic": false,
									"isConstant": true,
									"sid": 740422663919558
								},
								{
									"eventType": "variable",
									"name": "modName",
									"type": "string",
									"initialValue": "",
									"comment": "",
									"isStatic": true,
									"isConstant": false,
									"sid": 980837917848128
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "for",
											"objectClass": "System",
											"sid": 114918819476246,
											"parameters": {
												"name": "NOT_USED",
												"start-index": "LOOP_OFFSET",
												"end-index": "modRelationshipsArray.Height - LOOP_OFFSET"
											}
										},
										{
											"id": "compare-two-values",
											"objectClass": "System",
											"sid": 398814046826398,
											"parameters": {
												"first-value": "modRelationshipsArray.At(Functions.getColumnNumber(modRelationshipsArray.ObjectTypeName, MOD_TABLE_KEYWORD), loopindex)",
												"comparison": 0,
												"second-value": "modTable"
											}
										}
									],
									"actions": [
										{
											"id": "set-eventvar-value",
											"objectClass": "System",
											"sid": 229940860752355,
											"parameters": {
												"variable": "modName",
												"value": "modRelationshipsArray.At(Functions.getColumnNumber(modRelationshipsArray.ObjectTypeName, MOD_KEYWORD), loopindex)"
											}
										},
										{
											"id": "addProbabilityEntry",
											"objectClass": "advancedRandom",
											"sid": 502948481852683,
											"parameters": {
												"value": "modName",
												"weight": "int(Functions.arrayLookup(modsArray.ObjectTypeName, modName, RARITY_KEYWORD))"
											}
										}
									],
									"sid": 155290990287587
								},
								{
									"eventType": "block",
									"conditions": [],
									"actions": [
										{
											"id": "add-key",
											"objectClass": "localStorageDictionary",
											"sid": 349243004234116,
											"parameters": {
												"key": "modTable",
												"value": "advancedRandom.ProbabilityTableAsJSON"
											}
										}
									],
									"sid": 776561116968351
								}
							]
						},
						{
							"eventType": "block",
							"conditions": [],
							"actions": [
								{
									"id": "set-item",
									"objectClass": "LocalStorage",
									"sid": 228519452301981,
									"parameters": {
										"key": "localStorageDictionary.ObjectTypeName",
										"value": "localStorageDictionary.AsJSON"
									}
								}
							],
							"sid": 852797252785754
						}
					]
				}
			],
			"sid": 608494637955654
		}
	],
	"sid": 722961205554376
}